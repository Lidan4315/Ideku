@model Ideku.Models.Entities.Idea

@* ============================================================================
   IDEA WARNING COMPONENT - Handles two types of rejected ideas:
   1. INACTIVE: Auto-rejected after 60 days without approval (Yellow Warning)
   2. REJECTED: Manually rejected by approver (Red Warning)
   ============================================================================ *@

@if (Model.IsRejected)
{
    @* ========================================================================
       CASE 1: INACTIVE IDEA (Auto-Rejected - 60 Days Without Approval)
       Status: "Inactive"
       Color: Yellow (#ffc107)
       Reason: System-generated (e.g., "Auto-rejected: No approval for 60 days...")
       ======================================================================== *@
    @if (Model.CurrentStatus == "Inactive")
    {
        <div class="card shadow-sm mb-4 inactive-idea-card">
            <div class="card-body text-center py-5">
                <!-- Warning Icon (Yellow Triangle) -->
                <div class="mb-4">
                    <i class="bi bi-exclamation-triangle-fill inactive-warning-icon"></i>
                </div>

                <!-- Title -->
                <h4 class="mb-3 fw-bold text-dark">This Idea is Inactive</h4>

                <!-- Reason (Auto-rejection message) -->
                @if (!string.IsNullOrEmpty(Model.RejectedReason))
                {
                    <p class="text-muted mb-4 inactive-reason-text">
                        <strong>Reason:</strong> @Model.RejectedReason
                    </p>
                }

                <!-- Reactivate Button (Only for Superuser) -->
                @if (ViewBag.UserRole == "Superuser" && ViewBag.ShowReactivateButton == true)
                {
                    <form asp-controller="IdeaList" asp-action="ReactivateIdea" method="post" id="reactivateIdeaForm" class="d-inline">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="ideaId" value="@Model.Id" />
                        <button type="button" id="reactivateIdeaBtn" class="btn btn-success px-4 py-2">
                            <i class="bi bi-arrow-clockwise me-2"></i>Reactivate Idea
                        </button>
                    </form>
                }
            </div>
        </div>
    }
    @* ========================================================================
       CASE 2: REJECTED IDEA (Manually Rejected by Approver)
       Status: "Rejected S0", "Rejected S1", "Rejected S2", etc.
       Color: Red (#dc3545)
       Reason: Custom message from approver (e.g., "Budget tidak mencukupi")
       ======================================================================== *@
    else if (Model.CurrentStatus.StartsWith("Rejected S"))
    {
        <div class="card shadow-sm mb-4 rejected-idea-card">
            <div class="card-body text-center py-5">
                <!-- Warning Icon (Red X Circle) -->
                <div class="mb-4">
                    <i class="bi bi-x-circle-fill rejected-warning-icon"></i>
                </div>

                <!-- Title -->
                <h4 class="mb-3 fw-bold text-danger">This Idea is Rejected</h4>

                <!-- Rejection Stage Info -->
                <p class="text-muted mb-2">
                    <strong>Rejected at:</strong> @Model.CurrentStatus
                </p>

                <!-- Reason (Custom rejection message from approver) -->
                @if (!string.IsNullOrEmpty(Model.RejectedReason))
                {
                    <p class="text-muted mb-4 rejected-reason-text">
                        <strong>Reason:</strong> @Model.RejectedReason
                    </p>
                }

                <!-- Reactivate Button (Only for Superuser) -->
                @if (ViewBag.UserRole == "Superuser" && ViewBag.ShowReactivateRejectedButton == true)
                {
                    <form asp-controller="IdeaList" asp-action="ReactivateRejectedIdea" method="post" id="reactivateRejectedIdeaForm" class="d-inline">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="ideaId" value="@Model.Id" />
                        <button type="button" id="reactivateRejectedIdeaBtn" class="btn btn-danger px-4 py-2">
                            <i class="bi bi-arrow-clockwise me-2"></i>Reactivate Idea
                        </button>
                    </form>
                }
            </div>
        </div>
    }
}
